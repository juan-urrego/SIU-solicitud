
<p-toast></p-toast>
<p-card header="Proyectos" styleClass="p-card-shadow">

    <p-table [value]="proyectos">
        <ng-template pTemplate="header">
            <tr>                
                <th>Nombre del proyecto</th>
                <th>Código del proyecto</th>
                <th>Centro de costos</th>
                <th>Grupo de investigación asociado</th>
                <th>
                    <button type="button" pButton pRipple icon="pi pi-plus" (click)="openNew()"></button>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-proyecto>
            <tr>                
                <td>{{proyecto.nombre}}</td>
                <td>{{proyecto.codigoProyecto}}</td>
                <td>{{proyecto.centroCostos}}</td>
                <td>{{proyecto.grupo.nombre}}</td>
                <td>
                    <button type="button" pButton pRipple class="p-button-warning p-mr-2" icon="pi pi-pencil" (click)="openNew(proyecto)"></button>
                    <button type="button" pButton pRipple class="p-button-danger p-mr-2" icon="pi pi-trash" (click)="deleteProyecto(proyecto)"></button>
                </td>
            </tr>
        </ng-template>
    </p-table>
</p-card>

<p-dialog [(visible)]="proyectoDialog" [style]="{width: '600px'}"
          header="Proyecto" [modal]="true" styleClass="p-fluid">

          <ng-template pTemplate="content">
              <form [formGroup]="proyectoForm" novalidate>
                <div class="row">
                  <div class="col-12 mb-3 form-group">
      
                    <label for="nombre" class="col-form-label"><b>Nombre del proyecto:</b></label>            
                    <input id="nombre" class="form-control mb-3"
                    formControlName="nombre"  rows="5" type="text"
                    [ngClass]="{'is-invalid': (proyectoForm.get('nombre').touched || proyectoForm.get('nombre').dirty) && !proyectoForm.get('nombre').valid}">
                    <span class="invalid-feedback">
                      <span *ngIf="proyectoForm.get('nombre').errors?.required">
                        Por favor ingrese la necesidad.
                      </span>
                    </span>
                    
                  </div>
                </div>


                <div class="row">
                  <div class="col-12 mb-3 form-group">
      
                    <label for="grupo" class="col-form-label"><b>Grupo Asociado:</b></label>                                                                           
                    <p-dropdown [options]="grupos" formControlName="grupo" 
                                  placeholder="Seleccione grupo" optionLabel="nombre" 
                                  [ngClass]="{'is-invalid': (proyectoForm.get('grupo').touched || proyectoForm.get('grupo').dirty) && !proyectoForm.get('grupo').valid}"
                                  optionValue="id"></p-dropdown>
                    <span class="invalid-feedback">
                      <span *ngIf="proyectoForm.get('grupo').errors?.required">
                        Por favor ingrese la necesidad.
                      </span>
                    </span>
                    
                  </div>
                </div>
                <div class="row">
                  <div class="col-12 mb-3 form-group">
      
                    <label for="codigoProyecto" class="col-form-label"><b>Código de proyecto:</b></label>            
                    <input id="codigoProyecto" class="form-control mb-3"
                    formControlName="codigoProyecto"  rows="5" type="text"
                    [ngClass]="{'is-invalid': (proyectoForm.get('codigoProyecto').touched || proyectoForm.get('codigoProyecto').dirty) && !proyectoForm.get('codigoProyecto').valid}">
                    <span class="invalid-feedback">
                      <span *ngIf="proyectoForm.get('codigoProyecto').errors?.required">
                        Por favor ingrese la necesidad.
                      </span>
                    </span>
                    
                  </div>
                </div>
                  
                  
                <div class="row">
                  <div class="col-12 mb-3 form-group">
      
                    <label for="centroCostos" class="col-form-label"><b>Centro costos:</b></label>            
                    <input id="centroCostos" class="form-control mb-3"
                    formControlName="centroCostos"  rows="5" type="text"
                    [ngClass]="{'is-invalid': (proyectoForm.get('centroCostos').touched || proyectoForm.get('centroCostos').dirty) && !proyectoForm.get('centroCostos').valid}">
                    <span class="invalid-feedback">
                      <span *ngIf="proyectoForm.get('centroCostos').errors?.required">
                        Por favor ingrese la necesidad.
                      </span>
                    </span>
                    
                  </div>
                </div>
              </form>              
          </ng-template>
          <ng-template pTemplate="footer">      
            <button pButton pRipple label="Cancel" icon="pi pi-times" 
            class="p-button-text" (click)="hideDialog()"></button>
            <button pButton 
            [disabled]="proyectoForm.get('nombre').invalid" 
            pRipple label="Save" icon="pi pi-check" class="p-button-text" 
            (click)="saveProyecto()"></button>
            <button *ngIf="proyectoForm.get('id').value != 0" pButton pRipple 
            label="Delete" icon="pi pi-trash" class="p-button-text" 
            (click)="deleteProyecto(proyectoSelected)"></button>
          </ng-template>

</p-dialog>
<p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>
